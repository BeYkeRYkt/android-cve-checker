From de18d7858737e5c9491ee56070b192a04bfc7903 Mon Sep 17 00:00:00 2001
From: Dennis Cagle <d-cagle@codeaurora.org>
Date: Wed, 29 Nov 2017 13:05:00 -0800
Subject: [PATCH] msm: sensor: flash: add conditional check for ioctl

Add conditional check when sending VIDIOC_MSM_FLASH_CFG
in 32-bit process.

Change-Id: I73bcce85a212495ce94e6265947c11a6bc0e4040
CRs-Fixed: 2092793
Bug: 64836865
Git-repo: https://source.codeaurora.org/quic/la/kernel/msm-3.10
Git-commit: b153beb7af263b04ff6f79286eacba977e2f10eb
Signed-off-by: Tanvi Aggarwal <tanvia@codeaurora.org>
Signed-off-by: Dennis Cagle <d-cagle@codeaurora.org>
---
 drivers/media/platform/msm/camera_v2/sensor/flash/msm_flash.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/media/platform/msm/camera_v2/sensor/flash/msm_flash.c b/drivers/media/platform/msm/camera_v2/sensor/flash/msm_flash.c
index 0390e0e60deab..40d731bb858c2 100644
--- a/drivers/media/platform/msm/camera_v2/sensor/flash/msm_flash.c
+++ b/drivers/media/platform/msm/camera_v2/sensor/flash/msm_flash.c
@@ -1114,6 +1114,9 @@ static long msm_flash_subdev_do_ioctl(
 			break;
 		}
 		break;
+	case VIDIOC_MSM_FLASH_CFG:
+		pr_err("invalid cmd 0x%x received\n", cmd);
+		return -EINVAL;
 	default:
 		return msm_flash_subdev_ioctl(sd, cmd, arg);
 	}
