From f10f4e420dddc35dfef53965c55ffd5bdec41a45 Mon Sep 17 00:00:00 2001
From: Insun Song <isong@broadcom.com>
Date: Mon, 12 Oct 2015 23:31:12 -0700
Subject: [PATCH] net: wireless: bcmdhd: remove unnecessary PCIe memory access
 when BUS down.

In case PCIe BUS already down, we're not supposed to do access BAR0
area in any reason. One instance seen on test that made kernel panic.
removed disable irq calling which is useless in bus down case.

bug=24739315

Change-Id: I474e08c14c4dec0f4cc4cd207f29fef32e85ead7
Signed-off-by: Insun Song <isong@broadcom.com>
---
 drivers/net/wireless/bcmdhd/dhd_pcie.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/drivers/net/wireless/bcmdhd/dhd_pcie.c b/drivers/net/wireless/bcmdhd/dhd_pcie.c
index 21bbe54ee1889..1adffc366c679 100644
--- a/drivers/net/wireless/bcmdhd/dhd_pcie.c
+++ b/drivers/net/wireless/bcmdhd/dhd_pcie.c
@@ -2472,7 +2472,6 @@ dhd_bus_devreset(dhd_pub_t *dhdp, uint8 flag)
 				bus->dhd->busstate = DHD_BUS_DOWN;
 			} else {
 				if (bus->intr) {
-					dhdpcie_bus_intr_disable(bus);
 					dhdpcie_free_irq(bus);
 				}
 
