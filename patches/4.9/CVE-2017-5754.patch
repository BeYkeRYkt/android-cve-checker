From 1d9eca18de75307e09565a86126b0910b8bc901b Mon Sep 17 00:00:00 2001
From: Greg Hackmann <ghackmann@google.com>
Date: Tue, 16 Jan 2018 10:35:24 -0800
Subject: [PATCH] arm64: mm: update uaccess_disable_no_uao hack in
 __dma_flush_range

uaccess_disable_not_uao now uses a second temporary register for
stashing IRQ flags.  Again, update the out-of-tree uaccess macro usage
in __dma_flush_range to match.

Bug: 69856074
Change-Id: Ib114decb19f013107ebdd2d28a909631c0839f8b
Signed-off-by: Greg Hackmann <ghackmann@google.com>
---
 arch/arm64/mm/cache.S | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/arm64/mm/cache.S b/arch/arm64/mm/cache.S
index ddd16b5f6751f..5916469462637 100644
--- a/arch/arm64/mm/cache.S
+++ b/arch/arm64/mm/cache.S
@@ -276,7 +276,7 @@ ENTRY(__dma_flush_range)
 	cmp	x0, x1
 	b.lo	1b
 	dsb	sy
-	uaccess_disable_not_uao x1
+	uaccess_disable_not_uao x1, x2
 	ret
 ENDPIPROC(__dma_flush_range)
 
