From fe22ed6ec9c330e54242d19d154b8e7bb1fba336 Mon Sep 17 00:00:00 2001
From: Chenglu Lin <chenglulin@android.com>
Date: Wed, 28 Mar 2018 22:08:15 +0800
Subject: [PATCH] drivers: htc_debug: Avoid possible buffer overflow in
 reboot_block driver

Bug: 71363680
Change-Id: I1a07a74cae96b4548df4cb089e31485734149280
Signed-off-by: Chenglu Lin <chenglulin@android.com>
---
 drivers/htc_debug/stability/htc_reboot_block.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/htc_debug/stability/htc_reboot_block.c b/drivers/htc_debug/stability/htc_reboot_block.c
index 1c6df6ff5c412..4ed434696c0bd 100644
--- a/drivers/htc_debug/stability/htc_reboot_block.c
+++ b/drivers/htc_debug/stability/htc_reboot_block.c
@@ -49,7 +49,7 @@ static int reboot_block_command(int reason, const char* msg)
 
 	block.reason = reason;
 	memset(&block.msg[0], 0, sizeof(block.msg));
-	strlcpy(&block.msg[0], msg, strlen(msg));
+	strlcpy(&block.msg[0], msg, sizeof(block.msg));
 
 	snprintf(filename, sizeof(filename),
 			"/dev/block/%s/by-name/%s", bootdev, pname);
